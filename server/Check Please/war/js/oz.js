function Frac(e,a){e instanceof Frac?(this.n=e.n,this.d=e.d):(this.n=e,this.d=a||1,this.reduce())}var menu=menu||{};menu.items=[],function(e){e[0]={name:"Kale Dip",price:8e4},e[1]={name:"Cauliflower Patties",price:7e4},e[2]={name:"Meatball Sliders",price:8e4},e[3]={name:"Fries",price:6e4},e[4]={name:"Jerk Wings (large)",price:12e4},e[5]={name:"Jerk Wings",price:6e4},e[6]={name:"Pork Mac & Cheese",price:8e4},e[7]={name:"Mozzarella Sticks",price:8e4},e[8]={name:"Pulled Pork Sliders",price:8e4},e[9]={name:"Bruschetta",price:6e4},e[10]={name:"Stuffed Peppers",price:8e4},e[11]={name:"Tuna Nachos",price:1e5},e[12]={name:"Chicken Dip",price:8e4},e[13]={name:"Pepper Hummas",price:6e4},e[14]={name:"Guacamole",price:6e4},e[100]={name:"Thai Steak Salad",price:13e4},e[101]={name:"Grilled Shrimp Salad",price:12e4},e[102]={name:"Runs House Salad",price:1e5},e[103]={name:"Cobb Salad",price:1e5},e[104]={name:"Southwest Salad",price:13e4},e[105]={name:"Beet Salad",price:1e5},e[106]={name:"Argentinian Steak Salad",price:13e4},e[107]={name:"Social Market Salad",price:7e4},e[200]={name:"Tomato Soup",price:4e4},e[201]={name:"Du Hour Soup",price:5e4},e[202]={name:"Cheesy Tomato Soup",price:5e4},e[300]={name:"Italian Sandwitch",price:1e5},e[301]={name:"Chicken Sausage Sandwitch",price:1e5},e[302]={name:"Meatball Sandwitch",price:1e5},e[303]={name:"Stuffed Peper Sandwitch",price:1e5},e[304]={name:"Chicken Sandwitch",price:1e5},e[305]={name:"Cheese Burger",price:11e4},e[306]={name:"Turkey Burger",price:1e5},e[307]={name:"Veggy Burger",price:1e5},e[308]={name:"Steak Sandwitch",price:12e4},e[309]={name:"Cuban Sandwitch",price:1e5},e[310]={name:"Reuben",price:1e5},e[310]={name:"Blackened Mahi Sandwitch",price:13e4},e[400]={name:"Pepperoni Pizza",price:11e4},e[401]={name:"Pepperoni Pizza",price:18e4},e[402]={name:"Supreme Pizza",price:13e4},e[403]={name:"Supreme Pizza",price:2e5},e[404]={name:"BBQ Chicken Pizza",price:12e4},e[405]={name:"BBQ Chicken Pizza",price:19e4},e[406]={name:"Chicken Sausage Pizza",price:12e4},e[407]={name:"Chicken Sausage Pizza",price:19e4},e[408]={name:"Buffalo Chicken Pizza",price:12e4},e[409]={name:"Buffalo Chicken Pizza",price:19e4},e[410]={name:"Caprese Pizza",price:11e4},e[411]={name:"Caprese Pizza",price:18e4},e[412]={name:"Margherita Pizza",price:11e4},e[413]={name:"Margherita Pizza",price:18e4},e[414]={name:"Thai Chicken Pizza",price:12e4},e[415]={name:"Thai Chicken Pizza",price:19e4},e[416]={name:"Pierogi Pizza",price:12e4},e[417]={name:"Pierogi Pizza",price:19e4},e[418]={name:"Mushroom Pizza",price:13e4},e[419]={name:"Mushroom Pizza",price:2e5},e[420]={name:"Eggs & Ham Pizza",price:12e4},e[421]={name:"Eggs & Ham Pizza",price:19e4},e[422]={name:"Chipotle Sausage Pizza",price:12e4},e[423]={name:"Chipotle Sausage Pizza",price:19e4},e[424]={name:"Cauliflower Pizza",price:12e4},e[425]={name:"Cauliflower Pizza",price:19e4},e[500]={name:"Three Cheese Grilled Cheese",price:8e4},e[501]={name:"Fried Egg Grilled Cheese",price:8e4},e[502]={name:"Cheesy Bacon Grilled Cheese",price:8e4},e[600]={name:"Ice Cream Cookie Sandwitch",price:5e4},e[601]={name:"Cookies",price:3e4},e[602]={name:"Affogato",price:4e4},e[603]={name:"Affogato",price:6e4},e[700]={name:"Roasted Quinoa",price:4e4},e[701]={name:"Fries/Tots",price:4e4},e[702]={name:"Parmesan Orzo",price:3e4},e[703]={name:"Side Salad",price:4e4},e[800]={name:"Pita Pizza",price:6e4},e[801]={name:"Chicken Fingers",price:6e4},e[802]={name:"Grilled Cheese",price:6e4},e[900]={name:"Eggs in Hell",price:9e4},e[901]={name:"Steak & Eggs",price:11e4},e[902]={name:"Breakfast Pizza",price:1e5},e[903]={name:"Social Benny",price:9e4},e[904]={name:"Eggle Bagle",price:9e4},e[905]={name:"Scramble",price:8e4},e[906]={name:"Greek Yogurt & Granola",price:5e4},e[907]={name:"Bagel w/ Cream Cheese",price:3e4},e[1e3]={name:"Sam Adams Boston Lager",price:45e3},e[1004]={name:"Sam Adams Boston Lager",price:45e3,discount:25e3},e[1005]={name:"PBR",price:3e4},e[1009]={name:"PBR",price:3e4,discount:1e4},e[1010]={name:"Coors Light",price:35e3},e[1014]={name:"Coors Light",price:35e3,discount:15e3},e[1015]={name:"Barking Squirrel Lager",price:6e4},e[1020]={name:"Miller Light",price:35e3},e[1024]={name:"Miller Light",price:35e3,discount:15e3},e[1025]={name:"Heineken",price:4e4},e[1029]={name:"Heineken",price:4e4,discount:2e4},e[1030]={name:"Labatt Blue",price:4e4},e[1034]={name:"Labatt Blue",price:4e4,discount:2e4},e[1035]={name:"Yuengling Lager",price:35e3},e[1039]={name:"Yuengling Lager",price:35e3,discount:15e3},e[1040]={name:"Yuengling Light",price:35e3},e[1044]={name:"Yuengling Light",price:35e3,discount:15e3},e[1045]={name:"Sly Fox Pikeland Pils",price:4e4},e[1049]={name:"Sly Fox Pikeland Pils",price:4e4,discount:2e4},e[1050]={name:"Anderson Vally el Steinber",price:8e4},e[1055]={name:"Bud Light",price:35e3},e[1059]={name:"Bud Light",price:35e3,discount:15e3},e[1060]={name:"Stella",price:6e4},e[1065]={name:"Michelob Ultra",price:35e3},e[1069]={name:"Michelob Ultra",price:35e3,discount:15e3},e[1100]={name:"Blue Moon",price:5e4},e[1104]={name:"Blue Moon",price:5e4,discount:3e4},e[1105]={name:"Abita Purple Haze",price:5e4},e[1109]={name:"Abita Purple Haze",price:5e4,discount:3e4},e[1110]={name:"Goose Island 312",price:5e4},e[1114]={name:"Goose Island 312",price:5e4,discount:3e4},e[1200]={name:"Finch's Pale Ale",price:8e4},e[1205]={name:"Dale's Pale Ale",price:5e4},e[1209]={name:"Dale's Pale Ale",price:5e4,discount:3e4},e[1210]={name:"Sierra Nevada Pale Ale",price:5e4},e[1214]={name:"Sierra Nevada Pale Ale",price:5e4,discount:3e4},e[1215]={name:"Cisco Pale Ale",price:5e4},e[1219]={name:"Cisco Pale Ale",price:5e4,discount:3e4},e[1220]={name:"21st Amendment Bitter American",price:5e4},e[1224]={name:"21st Amendment Bitter American",price:5e4,discount:3e4},e[1300]={name:"Finch's Secret Stache",price:85e3},e[1305]={name:"Murphy's Irish Stout",price:6e4},e[1400]={name:"21st Amendment Back in Black",price:5e4},e[1404]={name:"21st Amendment Back in Black",price:5e4,discount:3e4},e[1405]={name:"21st Amendment Brew Free or Die",price:5e4},e[1409]={name:"21st Amendment Brew Free or Die",price:5e4,discount:3e4},e[1410]={name:"Finch's Threadless",price:85e3},e[1415]={name:"Rivertown Old Wylie IPA",price:5e4},e[1419]={name:"Rivertown Old Wylie IPA",price:5e4,discount:3e4},e[1500]={name:"Finch's Fascist Pig Ale",price:85e3},e[1505]={name:"Old Chub",price:6e4},e[1510]={name:"Woodchuck Amber Cider",price:5e4},e[1514]={name:"Woodchuck Amber Cider",price:5e4,discount:3e4},e[1515]={name:"Magic Hat No. 9",price:45e3},e[1519]={name:"Magic Hat No. 9",price:45e3,discount:25e3},e[1520]={name:"Finch's Golden Wing",price:7e4},e[1525]={name:"Yuengling Black & Tan",price:35e3},e[1529]={name:"Yuengling Black & Tan",price:35e3,discount:15e3},e[1530]={name:"O'Douls",price:35e3},e[1534]={name:"O'Douls",price:35e3,discount:15e3},e[1535]={name:"Rivertown Hala Kahiki",price:5e4},e[1539]={name:"Rivertown Hala Kahiki",price:5e4,discount:3e4},e[1540]={name:"Rivertown Maxwell's Scottish Ale",price:5e4},e[1544]={name:"Rivertown Maxwell's Scottish Ale",price:5e4,discount:3e4},e[1545]={name:"Anderson Valley Winter Solstice",price:6e4},e[1600]={name:"Miller Lite",price:3e4},e[1604]={name:"Miller Lite",price:3e4,discount:1e4},e[1605]={name:"Bud Light",price:3e4},e[1609]={name:"Bud Light",price:3e4,discount:1e4},e[1610]={name:"Yuengling",price:3e4},e[1614]={name:"Yuengling",price:3e4,discount:1e4},e[1615]={name:"Guinnes",price:55e3},e[1620]={name:"Pilsner Urquell",price:55e3},e[1700]={name:"Sangria",price:9e4},e[1701]={name:"Sangria",price:3e5},e[1702]={name:"Mojito",price:9e4},e[1703]={name:"Mojito",price:3e5},e[1704]={name:"Social Punch",price:9e4},e[1705]={name:"Social Punch",price:3e5},e[1706]={name:"Margarita",price:9e4},e[1707]={name:"Margarita",price:3e5},e[1708]={name:"Jacked Arnold Palmer",price:9e4},e[1709]={name:"Jacked Arnold Palmer",price:3e5},e[1800]={name:"Wolfhound",price:9e4},e[1801]={name:"The Dude",price:1e5},e[1802]={name:"Prosecco Cosmo",price:1e5},e[1803]={name:"CBS",price:1e5},e[1804]={name:"Bourbon Blast",price:9e4},e[1805]={name:"The Alamo",price:9e4},e[1806]={name:"Brooklyn Bridge",price:1e5},e[1807]={name:"Amaretto Sour",price:12e4},e[1900]={name:"Montepulciano d'Abruzzo, Masciarelli",price:1e5},e[1901]={name:"Montepulciano d'Abruzzo, Masciarelli",price:4e5},e[1902]={name:"Cabernet Sauvignon, Sean Minor",price:15e4},e[1903]={name:"Cabernet Sauvignon, Sean Minor",price:58e4},e[1904]={name:"Cabernet Sauvignon, Nickname",price:9e4},e[1905]={name:"Cabernet Sauvignon, Nickname",price:36e4},e[1906]={name:"Bordeaux, Charteau des Leotins",price:1e5},e[1907]={name:"Bordeaux, Charteau des Leotins",price:4e5},e[1908]={name:"Putto Chianti, Fattoria San Fabiano",price:12e4},e[1909]={name:"Putto Chianti, Fattoria San Fabiano",price:48e4},e[1910]={name:"Pinot Noir, Montoya",price:12e4},e[1911]={name:"Pinot Noir, Montoya",price:48e4},e[1912]={name:"Shiraz, Stalking Horse",price:14e4},e[1913]={name:"Shiraz, Stalking Horse",price:56e4},e[1914]={name:"Garnache, Acentor",price:11e4},e[1915]={name:"Garnache, Acentor",price:44e4},e[1916]={name:"Beaujolais, Domaine de Foretal",price:11e4},e[1917]={name:"Beaujolais, Domaine de Foretal",price:44e4},e[2e3]={name:"Sauvignon Blanc, Ranga Ranga",price:11e4},e[2001]={name:"Sauvignon Blanc, Ranga Ranga",price:44e4},e[2002]={name:"Trebbiano d'Abruzzo, Masciarelli",price:1e5},e[2003]={name:"Trebbiano d'Abruzzo, Masciarelli",price:4e5},e[2004]={name:"Chardonnay, Domaine Martinolles",price:9e4},e[2005]={name:"Chardonnay, Domaine Martinolles",price:36e4},e[2006]={name:"Pino Gris, A to Z",price:12e4},e[2007]={name:"Pino Gris, A to Z",price:48e4},e[2008]={name:"Chenin Blanc, Jovly",price:11e4},e[2009]={name:"Chenin Blanc, Jovly",price:44e4},e[2010]={name:"Sauvignon Blac, Honig",price:14e4},e[2011]={name:"Sauvignon Blac, Honig",price:56e4},e[2012]={name:"Estate Chardonnay, EOS",price:12e4},e[2013]={name:"Estate Chardonnay, EOS",price:48e4},e[2014]={name:"Rose, Chateau Jouclary",price:11e4},e[2015]={name:"Rose, Chateau Jouclary",price:44e4},e[2100]={name:"Brut Cava, Conde de Subirats",price:11e4},e[2101]={name:"Brut Cava, Conde de Subirats",price:44e4},e[2200]={name:"Rivertown, Grateful White",price:4e4},e[2205]={name:"Southern Teir, 2x One",price:8e4},e[2210]={name:"East End, Honey Heather",price:6e4},e[2215]={name:"East End, Big Hop IPA",price:6e4},e[2220]={name:"East End, Cream Ale",price:6e4},e[2225]={name:"Fatheads, Head Hunter IPA",price:6e4},e[2230]={name:"East End, Monkey Boy",price:6e4},e[2235]={name:"Strongbow, Hard Cider",price:5e4},e[2240]={name:"Kona, Koko Brown",price:6e4},e[2245]={name:"East End, Oatmeal Stout",price:6e4},e[2250]={name:"Green Flash, West Coast",price:7e4},e[3e3]={name:"Coffee",price:2e4},e[3001]={name:"Soda",price:2e4},e[3002]={name:"Ice Tea",price:2e4},e[3003]={name:"Decaf Coffee",price:2e4};for(var a in e)if("object"==typeof e[a]&&null!=e[a]&&null!=e[a].price){if(a>=1e3&&3e3>a){var n=e[a].price,i=e[a].discount;e[a].price=money.round(money.round(n/.0107)/100),i&&(e[a].discount=e[a].price-money.round(money.round((n-i)/.0107)/100))}e[a].tax=money.round(.07*(e[a].price-(e[a].discount||0)))}}(menu.items);var menu=menu||{};menu.mods=[],function(e){menu.mods[0]={name:"Extra Dressing",price:5e3},menu.mods[1]={name:"Extra Market Topping",price:5e3},menu.mods[2]={name:"Cheese",price:1e4},menu.mods[3]={name:"Nuts",price:1e4},menu.mods[4]={name:"Ahi Tuna",price:8e4},menu.mods[5]={name:"Anchovy",price:2e4},menu.mods[6]={name:"Bacon",price:1e4},menu.mods[7]={name:"Fried Chicken",price:4e4},menu.mods[8]={name:"Blackened Mahi",price:7e4},menu.mods[9]={name:"Grilled Chicken",price:4e4},menu.mods[10]={name:"Grilled Shrimp",price:6e4},menu.mods[11]={name:"Steak",price:7e4},menu.mods[12]={name:"Artichokes",price:1e4},menu.mods[13]={name:"Asparagus",price:1e4},menu.mods[14]={name:"Avocado",price:2e4},menu.mods[15]={name:"Beets",price:2e4},menu.mods[16]={name:"Deviled Egg",price:1e4},menu.mods[17]={name:"Fingerlings",price:2e4},menu.mods[18]={name:"Fries",price:1e4},menu.mods[19]={name:"Portobella",price:2e4},menu.mods[20]={name:"Roasted Red Peppers",price:1e4},menu.mods[21]={name:"Roasted Romatoes",price:2e4},menu.mods[100]={name:"Parm Orzo",price:1e4},menu.mods[101]={name:"Cheesy Tomato",price:1e4};for(var a in e)"object"==typeof e[a]&&null!=e[a]&&null!=e[a].price&&(e[a].tax=money.round(.07*(e[a].price-(e[a].discount||0))))}(menu.mods);var templates=templates||{};templates.itemMod=function(e,a){return'<li class="mod">	<span class="name">'+e+'</span>	<span class="price">'+a+"</span></li>"};var menu=menu||{};!function(){"use strict";function parse(e,a){var n=e.indexOf(":"),i=-1==n?e:e.substr(0,n),r={};return"$"==i[0]?(r.price=money.round(1e4*(parseFloat(i.substr(1))||0)),r.tax=money.round(.07*r.price)):$.extend(r,a[parseInt(e)]),-1!=n&&(r.name=e.substr(n+1).trim()),r}function makeKey(e){return e.name+(e.price?","+e.price:"")+(e.tax?"+"+e.tax:"")+(e.discount?"-"+e.discount:"")}function jqEscape(e){var a=$("<x>"),n=$("<y>");n.attr("v",e),a.append(n);var e=a.html();return e.substr(6,e.length-12)}menu.parse=function(raw){raw=raw.trim();for(var tokens=[],i=0;i<raw.length;){for(;0==raw[i].trim().length;)i++;if("{"==raw[i]){var j=raw.indexOf("}",i);if(-1==j)i=raw.length;else{for(var token=raw.substr(i+1,j-i-1),obj=null,k=token.length;null==obj&&k>0;k--)try{obj=eval("(function(){var x={"+token.substr(0,k)+"}; return x;})()")}catch(e){}null==obj&&(obj=new Object),tokens.push(obj),i=raw.indexOf(",",j)+1||raw.length}}else j=raw.indexOf(",",i),-1==j&&(j=raw.length),tokens.push(raw.substr(i,j-i).trim()),i=j+1}if(0==tokens.length)return null;var item=tokens[0];"string"==typeof item&&(item=parse(item,menu.items)),item.mods=[];for(var i=1;i<tokens.length;i++){var mod=tokens[i];"string"==typeof mod&&(mod=parse(mod,menu.mods)),null!=mod&&item.mods.push(mod)}return item};var lookup={};menu.unparse=function(e){if(null==e||"object"!=typeof e)return null;e=$.extend({},e);var a=e.mods;delete e.mods,delete e.id,delete e.orderDate;var n=lookup[makeKey(e)];if(null==n&&(n=jqEscape(JSON.stringify(e))),null!=a)for(var i=0;i<a.length;i++){var r=lookup[makeKey(a[i])];null==r&&(r=jqEscape(JSON.stringify(a[i]))),n+=","+r}return n};for(var i in menu.items)"object"==typeof menu.items[i]&&null!=menu.items[i]&&(lookup[makeKey(menu.items[i])]=i);for(var i in menu.mods)"object"==typeof menu.mods[i]&&null!=menu.mods[i]&&(lookup[makeKey(menu.mods[i])]=i)}();var models=models||{};!function(){"use strict";function e(e){alert("New payment!"),e.focus=!1,e.notification=!0,e.msgKey=null,e.statusCode=models.STATUS_NONE,e.statusMsg="",e.timeStamp=new Date,e.exprYear="20"+e.expr.slice(0,2),e.exprMonth=e.expr.slice(2);var a=e.tKey,n=e.cID,t=c[a];if(null!=t.byCID[n])for(var s=0;s<t.length;s++)t[s].cID==n&&t.splice(s,1);t.push(e),t.byCID[n]=e,drawTick(a,i[a],t,r[a])}function a(a){var i=$.noop,r=function(a){"ALERT:"==a.data.substr(0,6)?alert(a.data.substr(6).trim()):e(JSON.parse(a.data))},t=function(e){alert("SOCKET ERROR!  Please restart.\n\n"+JSON.stringify(e));var a=o;o=null,a.close()},s=function(){if(null!=o){alert("Socket closed!  Please restart.");var e=o;o=null,e.close()}};n(),o=new goog.appengine.Channel(a).open({onopen:i,onmessage:r,onerror:t,onclose:s}),o.onopen=i,o.onmessage=r,o.onerror=t,o.onclose=s}function n(){if(null!=o){var e=o;o=null,e.close()}}models.STATUS_FAIL=-1,models.STATUS_PAID=1,models.STATUS_NONE=0;var i,r,t=ajax.send.bind(ajax,"oz"),s="sjelin",c={};models.refresh=function(){t("connect",{restr:s},function(e){if(e=JSON.parse(e),a(e.token),e.ticks instanceof Array){i={};for(var n=0;n<e.ticks.length;n++)i["OZ"+n]=e.ticks[n]}else i=e.ticks;r={},drawBase(Object.keys(i));for(var t in i){var s=i[t],o=c[t];void 0==o&&(c[t]=o=[],o.byCID={}),drawTick(t,s,o,!1)}},buildAjaxErrFun("connect"))};var o=null;models.setItems=function(e,a){i[e]=a,r[e]=!0,drawTick(e,a,c[e],!0)},models.sendItemsUpdate=function(e){t("tick",{restr:s,i:parseInt(e.substr(2)),tick:JSON.stringify(i[e])},$.noop),r[e]=!1,drawTick(e,i[e],c[e],!1)},models.togglePaymentFocus=function(e,a){var n=c[e],t=!n.byCID[a].focus;if(t){n.byCID[a].notification=!1;for(var s in n.byCID)n.byCID[s].focus=s==a}else n.byCID[a].focus=!1;drawTick(e,i[e],n,r[e])},models.setPaymentStatus=function(e,a,n,s,o){var m=c[e].byCID[a];m.statusCode=s,m.statusMsg=o,m.msgKey=n,0!=s&&(m.focus=!1);var p={channelID:m.cID,msg:o,i:parseInt(e.substr(2)),items:m.itemsToPay,nums:m.payFracNums,denoms:m.payFracDenoms};switch(s){case models.STATUS_PAID:t("success",p,$.noop);break;case models.STATUS_FAIL:t("failure",p,$.noop);break;case models.STATUS_NONE:t("update",p,$.noop)}drawTick(e,i[e],c[e],r[e])},models.clear=function(e){for(var a=c[e],n=!1,i=0;i<a.length;i++){var r=a[i];if(r.statusCode==models.STATUS_NONE){if(!n&&(n=confirm("There are some outstanding payments on this table.  Are you sure you want to clear?"),!n))return;t("failure",{channelID:r.cID,msg:"Payment timmed out",i:parseInt(e.substr(2)),items:r.itemsToPay,nums:r.payFracNums,denoms:r.payFracDenoms},$.noop)}}c[e]=[],c[e].byCID={},models.setItems(e,[])}}();var templates=templates||{};templates.itemDesc=function(e,a,n){return'<li class="item">	<span class="name">'+e+'</span>	<span class="price">'+a+'</span>	<ul class="mods">'+n+"</ul></li>"};var templates=templates||{};templates.ticket=function(e){return'<div class="ticket" tKey="'+e+'">	<div class="input">		<h1>Input			<button class="clear">Clear</button>		</h1>		<div class="items"></div>		<div class="new item">			<a>+</a> <label>New Item</label>		</div>		<button class="update">Update Server</button>	</div>	<div class="info">		<h1>Items<span></span></h1>		<ul class="items"></ul>		<h2>Summary</h2>		<p class="subtotal"><strong>Subtotal:</strong>	<span></span></p>		<p class="tax">		<strong>Tax:</strong>		<span></span></p>		<p class="service">	<strong>Service:</strong>	<span></span></p>		<p class="discount"><strong>Discount:</strong>	<span></span></p>		<p class="tip">		<strong>Tip:</strong>		<span></span></p>		<p class="total">	<strong>Total:</strong>		<span></span></p>	</div>	<div class="payments">		<h1>Payments</h1>		<ul></ul>	</div></div>'},function(){"use strict";function e(){var e=$(this),a=[];e.find(".input .items .item").each(function(){var e=$(this),n=menu.parse(e.find("input").val());null!=n&&(n.id=e.attr("itemID"),n.orderDate=e.attr("orderDate"),a.push(n))}),models.setItems(e.attr("tKey"),a)}function a(){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var a=16*Math.random()|0,n="x"==e?a:3&a|8;return n.toString(16)});$(this).find(".input .items").append($(templates.itemIn(a,(new Date).getTime(),""))),e.call(this)}function n(){var a=$(this).parents(".ticket");$(this).parent().remove(),e.call(a[0])}function i(){var e=$(this).find("a");models.togglePaymentFocus(e.parents(".ticket").attr("tKey"),e.parents(".payment").attr("cID"))}function r(){var e=$(this),a=e.parents(".payment");if(!a.hasClass("paid")&&!a.hasClass("failed")){var n=e.parents(".ticket").attr("tKey"),i=a.attr("cID"),r=e.hasClass("success")?models.STATUS_PAID:e.hasClass("fail")?models.STATUS_FAIL:models.STATUS_NONE,t=e.attr("msg");models.setPaymentStatus(n,i,t,r,r==models.STATUS_PAID?"Success!":"limit"==t?"Not within credit limit":"invalid"==t?"Invalid credit information":"reject"==t?"Credit card rejected":"clear"==t?"Ticket already paid":"tech"==t?"Technical Difficulties":"other"==t?"Unknown failure cause":"enqueue"==t?"Entering queue":"terminal"==t?"Sending info":"processing"==t?"Card processing":"")}}window.drawBase=function(t){var s=$(".tickets");s.empty();var c=$(".nav");c.empty();for(var o=0;o<t.length;o++){var m=$(templates.ticket(t[o])),p=m.find(".input .items");p.on("keyup keydown keypress",".item input",e.bind(m[0])),p.on("click",".item a",n),m.find(".new.item").click(a.bind(m[0])),m.find(".input .clear").click(models.clear.c(t[o])),m.find(".input .update").click(models.sendItemsUpdate.c(t[o])),m.find(".payments").on("click",".payment",i),m.find(".payments").on("click",".payment .messages",!1),m.find(".payments").on("click",".messages > a",r),s.append(m);var l=$(templates.tickBtn(t[o]));l.css("left",100*(o+.5)/t.length+"%"),c.append(l)}(onhashchange||$.noop)()},window.drawTick=function(e,a,n,i){var r=$('.ticket[tKey="'+e+'"]'),t=r.find(".input .items"),s=0;if(t.children().each(function(){s+=null==menu.parse($(this).find("input").val())?0:1}),s!=a.length){t.empty();for(var c=0;c<a.length;c++){var o=a[c],m=menu.unparse(o);null!=m&&t.append($(templates.itemIn(o.id,o.orderDate,m)))}}r.find(".input .clear").toggle(a.length>0),r.find(".input .update").toggle(i===!0);for(var p=!1,l={},u=null,c=0;c<n.length;c++){for(var d=n[c],h=d.statusCode,g=h==models.STATUS_FAIL?"failed":h==models.STATUS_PAID?"paid":"none",f=d.pan.slice(-4);f.length<d.pan.length;)f="X"+f;var v=$(templates.payment(d.cID,g,d.msgKey,d.focus,d.notification,d.pan,d.name,d.exprMonth,d.exprYear,d.cvv,f));(l[h]||(l[h]=[])).push(v),p=p||d.notification,d.focus&&(u=d)}var S=r.find(".payments ul");if(S.empty(),S.append.apply(S,l[models.STATUS_NONE]),S.append.apply(S,l[models.STATUS_FAIL]),S.append.apply(S,l[models.STATUS_PAID]),$('.nav a.tBtn[tKey="'+e+'"]')[(p?"add":"remove")+"Class"]("notification"),null!=u){for(var y={},c=0;c<u.itemsToPay.length;c++)y[u.itemsToPay[c]]={num:u.payFracNums[c],denom:u.payFracDenoms[c]};a=$.extend(!0,[],a);for(var c=a.length-1;c>=0;c--){var k=y[a[c].id];null==k?a.splice(c,1):(a[c].paidNum=k.denom-k.num,a[c].paidDenom=k.denom)}}var C={subtotal:0,tax:0,service:0,discount:0,tip:100*((u||{}).tip||0)};t=r.find(".info .items"),t.empty();for(var c=0;c<a.length;c++){var o=a[c],P=o.paidDenom||1,b=P-(o.paidNum||0),A=(b!=P?"("+b+"/"+P+") ":"")+o.name||"&nbsp;",x=((o.price||0)-(o.discount||0))*b/P;C.subtotal+=x,C.tax+=(o.tax||0)*b/P,C.service+=(o.serviceCharge||0)*b/P,t.append($(templates.itemDesc(A,money.toStr(x/100),o.mods.map(function(e){var a=((e.price||0)-(e.discount||0))*b/P;return C.subtotal+=a,C.tax+=(e.tax||0)*b/P,C.service+=(e.serviceCharge||0)*b/P,templates.itemMod(e.name,a?money.toStr(a/100):"")}).join(""))))}C.total=C.subtotal+C.tax+C.service-C.discount+(C.tip||0);for(var c in C)r.find(".info ."+c+" span").text(money.toStr(C[c]/100));$(".info h1 span").text(u?"("+u.name+")":"")},window.onkeydown=function(e){13==e.keyCode&&$(".input .update:visible").click()}}();var templates=templates||{};templates.payment=function(e,a,n,i,r,t,s,c,o,m,p){return"<li class='payment "+a+(i?" focus":"")+(r?" notification":"")+(null!=n?" "+n:"")+"' cID=\""+e+"\">	<a class='title'>"+s+" ("+p+')</a>	<div class="card-info">		<p class="name"><strong>Name:</strong> '+s+'</p>		<p class="pan" ><strong>PAN: </strong> '+t+'</p>				<p class="expr"><strong>Expr:</strong> '+c+"/"+o+'</p>		<p class="cvv" ><strong>CVV: </strong> '+m+'</p>	</div>	<div class="messages">		<a class="success">Success</a>		<br />		<a class="fail" msg="limit"		>Limit</a>		<a class="fail" msg="invalid"	>Invalid</a>		<a class="fail" msg="reject"	>Reject</a>		<a class="fail" msg="clear"	>Paid</a>		<a class="fail" msg="tech"	>Tech</a>		<a class="fail" msg="other"	>Other</a>		<a class="update" msg="enqueue"		>Seen</a>		<a class="update" msg="terminal"	>Terminal</a>		<a class="update" msg="processing"	>Processing</a>	</div></li>'};var templates=templates||{};templates.itemIn=function(e,a,n){return'<div class="item" itemID="'+e+'" orderDate='+a+'>	<a>&times;</a> <input type="text" value="'+n+'" /></div>'},Frac.prototype.reduce=function(){var e=Math.gcd(this.n,this.d);this.n/=e,this.d/=e,this.d<0&&(this.n=-this.n,this.d=-this.d)},Frac.prototype.add=function(e,a){var n=new Frac(e,a);this.n=this.n*n.d+n.n*this.d,this.d=this.d*n.d,this.reduce()},Frac.prototype.sub=function(e,a){var n=new Frac(e,a);this.n=this.n*n.d-n.n*this.d,this.d=this.d*n.d,this.reduce()},Frac.prototype.mult=function(e,a){var n=new Frac(e,a);this.n=this.n*n.n,this.d=this.d*n.d,this.reduce()},Frac.prototype.div=function(e,a){var n=new Frac(e,a);this.n=this.n*n.d,this.d=this.d*n.n,this.reduce()},$(document).ready(function(){models.refresh()}),window.onhashchange=function(){"use strict";var e=(location.hash||"").slice(1);if($(".nav .tBtn").removeClass("focus"),$(".tickets > .ticket").hide(),e.startsWith("tick-")){var a=e.substr(5);$('.nav .tBtn[tKey="'+a+'"]').removeClass("focus"),$('.tickets > .ticket[tKey="'+a+'"]').show()}("refresh"==e||"reload"==e||"reconnect"==e)&&models.refresh()};var templates=templates||{};templates.tickBtn=function(e){return'<a class="tBtn" tKey="'+e+'" href="#tick-'+e+'">'+e+"</a>"};